这是一个非常关键的问题。引入中间变量 $z$ 的过程，其实就是**配方法（Completing the Square）**的直接产物。   [[中间变量去哪里了]] 

我们并不是凭空“猜”出这些变量的，而是通过代数变形，“凑”出完全平方项，然后把括号里的内容定义为新变量。

下面我一步步拆解这个过程，通过“**配方**”到“**换元**”的逻辑链条，你就能完全明白了。

---

### 第一步：对 $f(x)$ 进行配方

我们的目标是把含有交叉项（如 $x_1x_2$）的式子，变成只有平方项的和（如 $(\dots)^2 + (\dots)^2$）。

原式：
$$f(x_1,x_2,x_3) = x_1^2 + 2x_2^2 + 2x_3^2 + 2x_1x_2 - 2x_1x_3$$

**1. 处理 $x_1$：**
先把所有包含 $x_1$ 的项拿出来，凑成一个完全平方。
包含 $x_1$ 的项是：$x_1^2 + 2x_1x_2 - 2x_1x_3$。
根据公式 $(a+b+c)^2 = a^2+b^2+c^2+2ab+2ac+2bc$，我们观察 $x_1$ 的系数，可以构造：
$$(x_1 + x_2 - x_3)^2$$
我们把这个式子展开看看多了什么：
$$(x_1 + x_2 - x_3)^2 = \underbrace{x_1^2 + 2x_1x_2 - 2x_1x_3}_{\text{原式有的}} + \underbrace{x_2^2 - 2x_2x_3 + x_3^2}_{\text{多出来的}}$$
为了保持等式成立，我们需要在原式中**减去**这些多出来的项。

所以，$f(x)$ 变形为：
$$f(x) = \underbrace{(x_1 + x_2 - x_3)^2}_{\text{第一块平方}} - (x_2^2 - 2x_2x_3 + x_3^2) + \underbrace{2x_2^2 + 2x_3^2}_{\text{原式剩余项}}$$

**2. 整理剩余项：**
合并同类项：
$$f(x) = (x_1 + x_2 - x_3)^2 + x_2^2 + 2x_2x_3 + x_3^2$$

**3. 处理 $x_2$（继续配方）：**
观察剩下的部分 $x_2^2 + 2x_2x_3 + x_3^2$，这正好是一个完美的完全平方公式：
$$x_2^2 + 2x_2x_3 + x_3^2 = (x_2 + x_3)^2$$

**4. 最终配方结果：**
$$f(x) = (x_1 + x_2 - x_3)^2 + (x_2 + x_3)^2$$

---

### 第二步：引入中间变量 $z$（换元）

现在我们得到了两个“括号的平方”。为了让式子看起来像标准型 $z_1^2 + z_2^2$，我们直接**令括号里的内容等于 $z$**。

1.  把第一个平方里的内容设为 $z_1$：
    $$z_1 = x_1 + x_2 - x_3$$
2.  把第二个平方里的内容设为 $z_2$：
    $$z_2 = x_2 + x_3$$

**关键点来了：为什么要补一个 $z_3$？**

题目要求的是**可逆线性变换**。
*   原来的空间是 3 维的（有 $x_1, x_2, x_3$ 三个变量）。
*   变换后的空间也必须是 3 维的，我们需要 3 个新的变量 $z_1, z_2, z_3$ 才能构成一个满秩的矩阵（方阵）。
*   但是配方只配出了两项（说明这个二次型的秩是2，有些“退化”了）。

为了构造出一个 $3 \times 3$ 的可逆矩阵，我们需要人为补充第三个变量 $z_3$。
原则上，$z_3$ 可以取任何与 $z_1, z_2$ 线性无关的式子。最简单的方法是：**直接取原变量中剩下的那个，或者直接取 $x_3$**。

所以在配方结果中，虽然没有第三个平方项（系数为0），我们依然补充定义：
$$z_3 = x_3$$

---

### 总结

这组中间变量：
$$
\begin{cases} 
z_1 = x_1 + x_2 - x_3 & (\text{来自第一个括号}) \\
z_2 = x_2 + x_3       & (\text{来自第二个括号}) \\
z_3 = x_3             & (\text{为了补全 3 维坐标系})
\end{cases}
$$

这就是这组变量的由来。它不是猜测的，而是**配方过程的自然产物**加上**保持维数守恒的必要补充**。



---


