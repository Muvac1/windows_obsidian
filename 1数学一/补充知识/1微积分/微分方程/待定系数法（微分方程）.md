 #待定系数法 ，我们应该假设特解$y_p$具有与非齐次项类似的形式
### 1. 什么是待定系数法？

待定系数法是一种用来求解**特定类型**的非齐次线性微分方程的**特解**$y_p$的方法。

它适用于以下形式的方程：
$a_n y^{(n)} + a_{n-1}y^{(n-1)} + \dots + a_1 y' + a_0 y = f(x)$
其中：
*   **常系数**：$a_n, a_{n-1}, \dots, a_0$ 都是常数。
*   **线性**：方程中没有$y^2, (y')^2, y \cdot y'$等项。
*   **非齐次项$f(x)$** 必须是**特定形式**的函数。

### 2. 待定系数法的适用范围（关键！）

这个方法不是万能的，它只对特定形式的非齐次项$f(x)$有效。这些形式包括：

1.  **多项式函数**：例如 $f(x) = 3x^2 - 2$
2.  **指数函数**：例如 $f(x) = 5e^{3x}$
3.  **正弦或余弦函数**：例如 $f(x) = 2\cos(4x)$ 或 $f(x) = -\sin(4x)$
4.  **以上函数的有限和与积**：例如 $f(x) = x e^{2x}$ 或 $f(x) = e^{-x}\sin(3x)$ 或 $f(x) = x^2 + 5\cos x$

如果$f(x)$是像$\ln x, \tan x, \frac{1}{x}$这样的函数，待定系数法就不适用了（需要使用“常数变易法”）。

### 3. 核心思想

待定系数法的核心思想是“**你是什么，我就设什么**”。

我们观察到，上面列出的那些特定形式的函数，在求导后，其函数类型保持不变。
*   多项式求导后还是多项式。
*   $e^{ax}$求导后还是$e^{ax}$的倍数。
*   $\sin(kx)$和$\cos(kx)$求导后还是$\sin(kx)$和$\cos(kx)$的线性组合。

因此，我们可以根据非齐次项$f(x)$的形式，**猜测**一个包含未知系数（如A, B, C...）的特解$y_p$的形式。然后将这个猜测的解代入原微分方程，通过比较等式两边的同类项，反解出这些“待定”的系数。

### 4. 操作步骤与规则

#### **第一步：求解齐次解 $y_c$**

首先，解出对应的齐次方程$a_n y^{(n)} + \dots + a_0 y = 0$的通解$y_c$。**这一步至关重要**，因为它关系到后面最关键的修正规则。

#### **第二步：根据 $f(x)$ 的形式，初步猜测 $y_p$**

这里有一张基本规则表：

| 如果非齐次项 $f(x)$ 是...                               | 那么初步猜测的特解 $y_p$ 是...                                                                    |
| -------------------------------------------------------- | ------------------------------------------------------------------------------------------------- |
| $P_n(x)$ (一个 $n$ 次多项式)                               | $A_n x^n + A_{n-1} x^{n-1} + \dots + A_1 x + A_0$ (一个完整的 $n$ 次多项式)                     |
| $C e^{ax}$                                               | $A e^{ax}$                                                                                        |
| $C \cos(kx)$ 或 $C \sin(kx)$                               | $A \cos(kx) + B \sin(kx)$ (**注意：** 无论$f(x)$只有sin还是只有cos，猜测时必须两者都包含！) |
| $P_n(x) e^{ax}$                                          | $(A_n x^n + \dots + A_0) e^{ax}$                                                                  |
| $P_n(x) \cos(kx)$ 或 $P_n(x) \sin(kx)$                     | $(A_n x^n + \dots + A_0) \cos(kx) + (B_n x^n + \dots + B_0) \sin(kx)$                           |
| $e^{ax} \cos(kx)$ 或 $e^{ax} \sin(kx)$                     | $A e^{ax} \cos(kx) + B e^{ax} \sin(kx)$                                                           |

#### **第三步：检查与修正（最关键的一步！）**

将你在第二步中猜测的$y_p$与第一步得到的齐次解$y_c$进行比较。

**修正规则：** 如果你猜测的$y_p$中的**任何一项**与$y_c$中的某一项**形式相同**（常数系数不同没关系），那么你就必须将你**整个初步猜测**的$y_p$乘以$x$。如果乘以$x$后仍然有重复项，就再乘以一个$x$（即乘以$x^2$），直到没有任何一项与$y_c$中的项重复为止。

这个过程通常表示为将初步猜测乘以$x^k$，其中$k$是使$y_p$中不再含有$y_c$中项的最小正整数。

#### **第四步：代入原方程，求解系数**

将修正后的$y_p$及其各阶导数代入**原始的非齐次微分方程**中。通过合并同类项并使等式两边系数相等，建立一个关于待定系数(A, B, C...)的线性方程组，然后解出这些系数。

#### **第五步：写出特解和通解**

将解出的系数值代回$y_p$的表达式，得到特解。
方程的最终通解为 $y = y_c + y_p$。

---

### 用原题举例：$y'' + 4y' + 5y = 8\cos x$

#### **第一步：求解齐次解 $y_c$**

齐次方程为$y'' + 4y' + 5y = 0$。
特征方程为$r^2 + 4r + 5 = 0$，解得$r = -2 \pm i$。
所以齐次解为 $y_c = e^{-2x}(C_1 \cos x + C_2 \sin x)$。

#### **第二步：初步猜测 $y_p$**

非齐次项$f(x) = 8\cos x$。
根据规则表，当$f(x)$是$\cos(kx)$或$\sin(kx)$的形式时，我们的猜测必须包含两者。这里$k=1$。
所以，初步猜测 $y_p = A \cos x + B \sin x$。

#### **第三步：检查与修正**

比较$y_p$和$y_c$：
*   $y_p$中的项是：$A\cos x$, $B\sin x$
*   $y_c$中的项是：$C_1 e^{-2x}\cos x$, $C_2 e^{-2x}\sin x$

$y_p$中的项（如$\cos x$）和$y_c$中的项（如$e^{-2x}\cos x$）**形式不同**（因为$y_c$中有一个$e^{-2x}$因子）。没有重复项。
因此，我们的初步猜测是正确的，**无需修正**。

#### **第四步：代入求解**

我们已经确定了特解形式为 $y_p = A \cos x + B \sin x$。
求导：
$y_p' = -A \sin x + B \cos x$
$y_p'' = -A \cos x - B \sin x$

代入原方程 $y'' + 4y' + 5y = 8\cos x$:
$(-A \cos x - B \sin x) + 4(-A \sin x + B \cos x) + 5(A \cos x + B \sin x) = 8\cos x$

整理合并同类项：
$(-A + 4B + 5A)\cos x + (-B - 4A + 5B)\sin x = 8\cos x + 0\sin x$
$(4A + 4B)\cos x + (-4A + 4B)\sin x = 8\cos x + 0\sin x$

比较等式两边$\cos x$和$\sin x$的系数：
$\begin{cases} 4A + 4B = 8 \\ -4A + 4B = 0 \end{cases}$
解这个方程组得到：
$A=1, B=1$

#### **第五步：写出特解**

将$A=1, B=1$代回$y_p$的表达式：
$y_p = 1 \cdot \cos x + 1 \cdot \sin x = \cos x + \sin x$
这就是我们求得的一个特解。

（原题的后续步骤是结合$y_c$和$y_p$得到通解，再利用边界条件确定$C_1$和$C_2$）。

---

### 再举一个需要修正的例子

求解 $y'' - 2y' - 3y = 4e^{3x}$

1.  **求$y_c$**:
    特征方程 $r^2 - 2r - 3 = 0 \implies (r-3)(r+1)=0$。
    根为 $r_1=3, r_2=-1$。
    齐次解 $y_c = C_1 e^{3x} + C_2 e^{-x}$。

2.  **初步猜测$y_p$**:
    $f(x) = 4e^{3x}$，是$Ce^{ax}$的形式，其中$a=3$。
    初步猜测 $y_p = A e^{3x}$。

3.  **检查与修正**:
    比较$y_p = A e^{3x}$与$y_c = C_1 e^{3x} + C_2 e^{-x}$。
    我们发现，猜测的$A e^{3x}$与$y_c$中的$C_1 e^{3x}$**形式完全相同**！
    **必须修正！** 将初步猜测乘以$x$。
    修正后的猜测为 $y_p = A x e^{3x}$。
    再次检查，$A x e^{3x}$与$y_c$中的任何一项都不同。修正完成。

4.  **代入求解**:
    $y_p = A x e^{3x}$
    $y_p' = A e^{3x} + 3A x e^{3x}$ (使用乘法法则)
    $y_p'' = 3A e^{3x} + 3A e^{3x} + 9A x e^{3x} = 6A e^{3x} + 9A x e^{3x}$

    代入原方程 $y'' - 2y' - 3y = 4e^{3x}$:
    $(6A e^{3x} + 9A x e^{3x}) - 2(A e^{3x} + 3A x e^{3x}) - 3(A x e^{3x}) = 4e^{3x}$

    合并同类项（$xe^{3x}$项和$e^{3x}$项）：
    $x e^{3x}$的系数：$9A - 2(3A) - 3A = 9A - 6A - 3A = 0$。（这里的系数为0是必然的，因为修正的目的就是如此）
    $e^{3x}$的系数：$6A - 2(A) = 4A$。

    所以方程变为 $4A e^{3x} = 4e^{3x}$。
    显然，$4A=4 \implies A=1$。

5.  **写出特解**:
    $y_p = 1 \cdot x e^{3x} = x e^{3x}$。

希望这个详细的解释能让你彻底明白待定系数法！