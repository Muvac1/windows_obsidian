1.  **文件分配方式**
    *   **连续分配**：要求文件在磁盘上占用连续的一组块。优点是读写速度快，支持随机访问。缺点是会产生外部碎片，且文件不易扩展。
    *   **链接分配**：文件的数据块可以离散地存放在磁盘各处，通过指针链起来。优点是无外部碎片。缺点是不支持高效的随机访问，且指针会占用额外空间。
    *   **索引分配**：为每个文件分配一个索引块，索引块中存放指向文件所有数据块的指针。FCB中只需存放索引块的地址。优点是既支持随机访问，又无外部碎片。缺点是索引块本身会占用额外空间。这是现代操作系统（如Linux的ext系列）普遍采用的方式。
#### 1. 连续分配 (Contiguous Allocation)

*   **定义**：要求每个文件在磁盘上占用一组连续的块。
*   **优点**：
    *   **访问速度快**：支持顺序访问和随机访问，两者都很快。因为数据块连续，所以一次寻道后可以连续读取大量数据，减少了寻道次数。
    *   **结构简单**：目录条目中只需存储起始地址和长度。
*   **缺点**：
    *   **文件不易扩展**：如果文件创建后需要增长，其后可能没有连续空间，导致无法扩展或需要移动整个文件。
    *   **外部碎片**：多次创建和删除文件后，磁盘上会产生许多不连续的小空闲块，即使总空闲空间足够，也可能无法为一个新文件分配空间。
*   **地址转换**：逻辑地址 `A` 转换为物理块号 `P` 的公式为：
    $P = \text{StartBlock} + \lfloor \frac{A}{\text{BlockSize}} \rfloor$
    其中 `StartBlock` 是文件的起始块号。

#### 2. 链式分配 (Linked Allocation)

*   **定义**：文件的数据块可以离散地存放在磁盘的任何位置。通过每个块中的指针将它们链接起来。
*   **优点**：
    *   **无外部碎片**：可以利用任何空闲块。
    *   **文件易于扩展**：只需在链表末尾添加新块即可。
*   **缺点**：
    *   **不支持高效的随机访问**：必须从头开始遍历链表。
    *   **可靠性差**：指针损坏会导致后续数据丢失。
    *   **指针占用空间**：每个块都需要一部分空间存储指针，降低了存储效率。
*   **变种：文件分配表 (FAT)**：将所有块的链接指针集中存放在一个叫做 FAT 的表中。这改善了随机访问性能（只需在内存中查表，但仍比连续分配慢），也提高了可靠性。

#### 3. 索引分配 (Indexed Allocation)

*   **定义**：为每个文件创建一个索引块，其中包含了指向该文件所有数据块的地址列表。
*   **优点**：
    *   **支持直接访问/随机访问**：通过索引块可以直接定位到任何数据块。
    *   **无外部碎片**。
    *   **文件易于扩展**：只需在索引块中添加新条目并分配数据块。
*   **缺点**：
    *   **索引块开销**：即使是很小的文件，也需要一个完整的索引块，造成空间浪费。对于大文件，单个索引块可能不够用。
*   **多级索引**：为解决大文件问题，可以建立多级索引。例如，一级索引块不直接指向数据块，而是指向二级索引块。这种方式可以支持非常大的文件，但代价是访问数据时需要更多的磁盘 I/O。
*   **混合索引**：UNIX/Linux 系统采用的经典方式。一个 inode（索引节点）中包含少量直接指针、一个一级间接指针、一个二级间接指针和一个三级间接指针，兼顾了小文件的高效访问和对大文件的支持。
[[文件分配方式（文件物理结构）]] 