1.  **数据与分组计算**
    *   文件大小：980,000 B
    *   分组总大小：1000 B
    *   分组头大小：20 B
    *   每个分组能携带的数据（净荷 Payload）：1000 B - 20 B = 980 B
    *   需要的分组数量：`文件大小 / 每个分组的数据大小 = 980,000 B / 980 B = 1000 个分组`
    *   需要传输的总数据量（文件+所有分组头）：`分组数量 × 分组总大小 = 1000 × 1000 B = 1,000,000 B = 1 MB`

2.  **确定路径**
    *   题目要求“至少”的时间，因此必须选择**最短路径**。
    *   从图上看，从 H1 到 H2 的最短路径经过 **2个** 分组交换机。这意味着数据从 H1 发出后，要被转发两次才能到达 H2。整个路径共有 **3段** 链路。

3.  **计算总时间（流水线思想）**
    *   总时间的计算可以看作一个流水线模型。总时间取决于**最后一个分组**何时被 H2 完全接收。
    *   **第一部分：H1 发送所有分组的时间**
        *   H1 需要将全部1000个分组（总计1MB数据）都推送到第一段链路上。
        *   时间 = `总数据量 / 带宽 = (1 MB × 8) / 100 Mbps = 8,000,000 bit / 100,000,000 bit/s = 0.08 s = 80 ms`。
        *   在 **t = 80ms** 这个时刻，最后一个分组的最后一个比特**刚刚离开** H1。

    *   **第二部分：最后一个分组在网络中的转发时间** #数据转发 
        *   当最后一个分组离开H1后，它还需要经过2个交换机的“存储—转发”。
        *   每次转发所需的时间，就是转发这**一个分组**的传输时延。
        *   单个分组的传输时延 `t0 = 单个分组大小 / 带宽 = (1000 B × 8) / 100 Mbps = 8000 bit / 100,000,000 bit/s = 0.00008 s = 0.08 ms`。
        *   这个最后一个分组需要被转发 **2 次**，所以它在中间节点上的总转发延迟为 `2 × t0 = 2 × 0.08 ms = 0.16 ms`。

    *   **最终总时间**
        *   总时间 = (H1发送全部数据的时间) + (最后一个分组在后续路径上的转发时间)
        *   `T_total = 80 ms + 0.16 ms = 80.16 ms`
        *   所以，H2 接收完所有数据，至少需要 80.16ms。
---
衍生考点
1.  **引入传播时延**
    *   **题目变化**：题目会给出每段链路的长度（如 100km）和信号传播速度（如 2 × 10⁸ m/s）。
    *   **解法变化**：总时间需要在原基础上，加上整个路径的**总传播时延**。因为最后一个分组的第一个比特需要走完3段链路。
    *   `传播时延 (每段) = 100,000 m / (2 × 10⁸ m/s) = 0.5 ms`
    *   `总传播时延 = 3 × 0.5 ms = 1.5 ms`
    *   `新的总时间 = 80.16 ms + 1.5 ms = 81.66 ms`


2.  **考察直通交换 (Cut-through Switching)**
    *   **题目变化**：明确指出交换机采用“直通交换”而非“存储—转发”。
    *   **解法变化**：在直通交换中，交换机收到分组头部确定转发端口后，就立刻开始转发，无需等待整个分组收完。因此，交换机引入的延迟极小（可忽略，或只算一个头部的传输时间）。总时间主要由 H1 的发送时间和整个链路的传播时延构成。
    *   `总时间 ≈ H1发送所有数据的时间 + 整个路径的传播时延`
    *   `T_total ≈ 80ms + 3 × (传播时延/段)`

3.  **对比电路交换 (Circuit Switching)**
    *   **题目变化**：假设同一网络拓扑，但采用电路交换，并给出电路建立时间（如 50ms）。
    *   **解法变化**：电路交换的总时间与分组数量无关。
    *   `总时间 = 电路建立时间 + 数据传输时间 + 传播时延`
    *   `数据传输时间 = 总数据量 / 带宽 = (1 MB × 8) / 100 Mbps = 80 ms`
    *   `总时间 = 50 ms + 80 ms + (传播时延)`

4.  **考虑确认帧 (ACK)**
    *   **题目变化**：要求计算 H1 发送完文件并收到 H2 的一个确认信息（ACK）所需要的时间。ACK分组大小通常很小（如 64B）。
    *   **解法变化**：需要在文件传输总时间的基础上，再加上 ACK 的返回时间。
    *   `ACK返回时间 = ACK的传输时延(在H2) + 3段链路的传播时延 + 2次ACK的转发时延`
    *   这是一个更复杂的计算，因为它综合了数据传输和返回确认两个过程。
