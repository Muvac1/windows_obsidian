1.  **流量控制 (Flow Control) 与 接收窗口 (rwnd - Receiver Window)**
    *   **目的**: 防止发送方发送数据的速度过快，导致接收方的缓冲区溢出。
    *   **机制**: TCP连接的每一方都有一个接收缓冲区。接收方会在发送给对方的每一个ACK报文中，通过TCP头部的“窗口大小”字段，通告自己接收缓冲区的剩余空间大小。这个值就是`rwnd`。
    *   **规则**: 发送方必须保证其已发送但未收到确认的数据量，不能超过对方通告的`rwnd`。这可以表示为：$LastByteSent - LastByteAcked \le rwnd$。

2.  **拥塞控制 (Congestion Control) 与 拥塞窗口 (cwnd - Congestion Window)**
    *   **目的**: 防止大量数据注入网络，导致网络中的路由器或链路过载，即网络拥塞。
    *   **机制**: 这是发送方自己维护的一个状态变量，它代表了发送方对网络拥塞程度的估计。`cwnd`的大小会根据网络的状况动态变化（通过ACK的接收情况和丢包事件来判断）。
    *   **规则**: 发送方在任何时刻已发送但未收到确认的数据量，也不能超过`cwnd`。这可以表示为：$LastByteSent - LastByteAcked \le cwnd$。

**综合决策**:
由于发送方必须同时满足流量控制和拥塞控制的要求，因此它真正能发送的数据量上限，必须取这两个窗口中的**最小值**。这就是本题解题的第一步，也是最关键的一步。