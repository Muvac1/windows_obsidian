IEEE 802.11 帧的通用格式包含多个部分  
#IEEE802-11数据帧头  (MAC Header)   
$MAC Header = FrameControl | Duration/ID | Addr1 | Addr2 | Addr3 | SeqCtrl | Addr4$

其中 **Frame Control** 字段中的两位 `To DS` 和 `From DS` 决定了 `Addr1` 到 `Addr4` 的具体含义。DS (Distribution System) 指的是连接各个 AP 的骨干网络，通常就是我们说的有线局域网。

*   `To DS = 1` 表示帧的目的地是 DS。
*   `From DS = 1` 表示帧的来源是 DS。

下面我们详细分析四种情况，这也是最常见的考点。

**1. 衍生考点一：Ad-hoc 模式 (IBSS)**

*   **场景:** 两台无线设备直接通信，没有 AP。
*   **标志:** $To DS=0$, $From DS=0$
*   **地址分配:**
    *   **地址1 (RA):** 目的设备的 MAC (DA)。
    *   **地址2 (TA):** 源设备的 MAC (SA)。
    *   **地址3:** BSSID (在 Ad-hoc 模式下是一个随机生成的 MAC 地址，用于标识这个临时网络)。
*   **考题形式:** 给出两台笔记本电脑直接传文件的场景，询问帧地址。

**2. 衍生考点二：AP 发送数据给无线主机 (From AP)**

*   **场景:** Internet 上的服务器响应了主机 H 的请求，数据经由 R -> AP -> H。我们分析 AP 发送给 H 的这一段无线帧。
*   **标志:** $To DS=0$, $From DS=1$
*   **地址分配:**
    *   **地址1 (RA):** 目的设备 H 的 MAC (DA)。
    *   **地址2 (TA):** AP 的 MAC (BSSID)。
    *   **地址3:** 最初的源设备 R 的 MAC (SA)。
*   **考题形式:** 与原题相反，询问从 Internet 返回给主机 H 的 802.11 帧的地址。

**3. 衍生考点三：无线桥接模式 (WDS)**

*   **场景:** 两个 AP 之间通过无线方式进行通信，以扩展网络覆盖范围。例如，数据从 AP1 覆盖下的主机 H 发送到 AP2 覆盖下的另一台主机。
*   **标志:** $To DS=1$, $From DS=1$
*   **地址分配:** 这是唯一使用全部四个地址字段的场景。
    *   **地址1 (RA):** 接收方 AP (AP2) 的 MAC。
    *   **地址2 (TA):** 发送方 AP (AP1) 的 MAC。
    *   **地址3:** 最终目的主机 (DA) 的 MAC。
    *   **地址4:** 最初源主机 (SA) 的 MAC。
*   **考题形式:** 给出包含无线中继或桥接的拓扑图，询问 AP 间转发的帧地址。


总结一下，Wi-Fi 地址复杂的根本原因：

1.  **有一个“中间人” (AP):** 无线设备（手机、电脑）不能直接和路由器对话，它必须通过 AP 作为“翻译”和“桥梁”。AP 连接着**无线世界**和**有线世界 (DS)**。因此，一个数据帧必须同时说清楚两件事：
    *   **在无线世界里，是谁发给谁？** (这就是 **TA** 和 **RA** 的作用)
    *   **在整个网络旅程中，最初是谁发给最终谁？** (这就是 **SA** 和 **DA** 的作用)

2.  **需要支持多种通信模式：** Wi-Fi 的设计者必须考虑到各种复杂场景，而不仅仅是你上网这一种。他们用一套地址规则，通过调整 `To DS` 和 `From DS` 两个标志位，就能完美适配所有情况：
    *   **场景A (本题):** 你的电脑发数据给 AP，想上网。 (`To DS=1, From DS=0`)
    *   **场景B:** AP 把从网上下载的数据发给你的电脑。 (`To DS=0, From DS=1`)
    *   **场景C:** 两台笔记本电脑不用 AP，直接互传文件 (Ad-hoc 模式)。 (`To DS=0, From DS=0`)
    *   **场景D:** 两个 AP 之间用无线连接来扩展信号 (WDS 桥接)。 (`To DS=1, From DS=1`)

如果只用简单的“源/目的”两个地址，根本无法区分和处理这么多种复杂的场景。

### 简单来说：

*   **以太网的两个地址，回答的是：“最终谁发给最终谁？”**
*   **Wi-Fi 的三个（或四个）地址，回答的是：“最终谁发给最终谁，其中在无线这段路上，具体是谁发给了谁？”**