伸展树的单次操作在最坏情况下可能是$O(n)$（例如，当树退化成一条链时），但我们通常使用 #摊还分析 来证明其长期性能是高效的。 #势能法 是摊还分析的一种常用技术。

其核心思想是为数据结构定义一个**势能函数** $\Phi$，它将数据结构的某个状态映射为一个非负数。一次操作的**摊还代价** (Amortized Cost) 定义为：

$摊还代价 = 实际代价 + \Delta\Phi$

其中，$\Delta\Phi$ 是操作前后的势能变化量 ($\Phi_{after} - \Phi_{before}$)。

对于 #伸展树 ，我们定义势能函数如下：
1.  对于树中的任意节点 $x$，定义其**大小** $s(x)$ 为以 $x$ 为根的子树中的节点数量（包括 $x$ 本身）。
2.  定义节点 $x$ 的**秩** (rank) 为 $r(x) = \log_2(s(x))$。
3.  整棵树 $T$ 的**总势能** $\Phi(T)$ 是所有节点秩的总和：
    $\Phi(T) = \sum_{x \in T} r(x) = \sum_{x \in T} \log_2(s(x))$
