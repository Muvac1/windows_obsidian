![[Pasted image 20251216204909.png]]

这张图片列出了操作系统内存管理章节中**“可能会考，但是真题尚未考过”**的五个高频潜在考点。

针对这五个知识点，我为你设计了具有针对性的模拟习题（包含计算题和概念题），并提供了详细的解答与分析，帮助你查漏补缺。

---

### 知识点一：局部页面置换算法的具体缺页情况的计算

**【考点解读】**
这里指的是在给定的物理块数（驻留集大小固定）下，使用如 **LRU（最近最久未使用）**、**FIFO（先进先出）** 或 **OPT（最佳置换）** 算法，计算具体的缺页次数或缺页率。虽然以前考过简单的，但现在的趋势可能会考更复杂的序列或对比。

**【模拟习题 1】**
在一个采用页式虚拟存储管理的系统中，某进程被分配了 **3个** 页框（物理块）。现有一段页面访问序列如下：
`7, 0, 1, 2, 0, 3, 0, 4, 2, 3, 0, 3, 2`
请分别计算采用 **LRU（最近最久未使用）** 算法和 **FIFO（先进先出）** 算法时的**缺页次数**。
（注：初始时内存为空，首次装入页面也计入缺页）

**【答案与解析】**

**1. LRU 算法（Least Recently Used）：**
原则：置换掉那个“最近最长时间没有被访问”的页面。

| 访问页面 | 内存状态 (栈底 -> 栈顶) | 是否缺页 | 操作说明 |
| :--- | :--- | :--- | :--- |
| **7** | 7 | **是** | 装入7 |
| **0** | 7, 0 | **是** | 装入0 |
| **1** | 7, 0, 1 | **是** | 装入1 (填满) |
| **2** | 0, 1, 2 | **是** | 7最久未用，换出7，装入2 |
| **0** | 1, 2, 0 | 否 | 0命中，0移至栈顶 (最新) |
| **3** | 2, 0, 3 | **是** | 1最久未用，换出1，装入3 |
| **0** | 2, 3, 0 | 否 | 0命中，0移至栈顶 |
| **4** | 3, 0, 4 | **是** | 2最久未用，换出2，装入4 |
| **2** | 0, 4, 2 | **是** | 3最久未用，换出3，装入2 |
| **3** | 4, 2, 3 | **是** | 0最久未用，换出0，装入3 |
| **0** | 2, 3, 0 | **是** | 4最久未用，换出4，装入0 |
| **3** | 2, 0, 3 | 否 | 3命中，移至栈顶 |
| **2** | 0, 3, 2 | 否 | 2命中，移至栈顶 |

*   **LRU 缺页次数 = 9 次**

**2. FIFO 算法（First In First Out）：**
原则：置换掉最早进入内存的页面。

| 访问页面 | 内存状态 (队头 -> 队尾) | 是否缺页 | 操作说明 |
| :--- | :--- | :--- | :--- |
| **7** | 7 | **是** | 装入 |
| **0** | 7, 0 | **是** | 装入 |
| **1** | 7, 0, 1 | **是** | 装入 |
| **2** | 0, 1, 2 | **是** | 7最早进入，换出7 |
| **0** | 0, 1, 2 | 否 | 0命中，FIFO不更新顺序 |
| **3** | 1, 2, 3 | **是** | 0最早进入，换出0 |
| **0** | 2, 3, 0 | **是** | 1最早进入，换出1 |
| **4** | 3, 0, 4 | **是** | 2最早进入，换出2 |
| **2** | 0, 4, 2 | **是** | 3最早进入，换出3 |
| **3** | 4, 2, 3 | **是** | 0最早进入，换出0 |
| **0** | 2, 3, 0 | **是** | 4最早进入，换出4 |
| **3** | 2, 3, 0 | 否 | 3命中 |
| **2** | 2, 3, 0 | 否 | 2命中 |

*   **FIFO 缺页次数 = 10 次**

---

### 知识点二：缺页率页面置换算法(PFF) 和 工作集页面置换算法

**【考点解读】**
这两个属于**全局置换算法**（分配给进程的物理块数是可变的）。重点在于理解它们如何动态调整驻留集大小。
*   **PFF**：根据缺页间隔时间来调整。
*   **工作集算法**：根据固定的时间窗口 $\Delta$ 维护活跃页面集合。

**【模拟习题 2】**
**(1) 工作集算法计算：**
某进程的页面访问序列为：`... 2, 6, 1, 5, 7, 7, 7, 5`。
假设工作集窗口大小 $\Delta = 4$。请写出在访问完最后一个页面 `5` 时刻的**工作集（Working Set）**包含哪些页面？

**(2) PFF 算法原理判断：**
在缺页率置换算法（PFF）中，系统设定了一个缺页率阈值（或者说缺页间隔阈值 $T$）。
如果某次发生缺页，且距离上次缺页的时间间隔 $t < T$（说明缺页太频繁），系统会执行什么操作？
A. 将该进程挂起
B. 换出当前内存中所有未被引用的页面
C. 为该进程增加一个物理块，将新页面装入
D. 减少该进程的一个物理块

**【答案与解析】**

**(1) 答案：{1, 5, 7}**
*   **解析：** 工作集 $WS(t)$ 是指在时刻 $t$ 往前推 $\Delta$ 个单位时间内访问过的**不重复**页面集合。
*   序列末尾是 `... 7, 7, 7, 5`。
*   往前推 4 次访问：分别是 `5, 7, 7, 7`。（注意：这里虽然7访问了3次，但工作集是页面的集合，去重）。
*   再往前一个是 `1`，但窗口大小是4，所以看 `5, 7, 7, 7` 这一段。实际上通常包含当前时刻，若当前是5，前3个是7,7,7。若包含更早的 `1` 则需看具体的窗口定义（通常指最近的 $\Delta$ 次引用）。
*   如果是指最近4次引用：`7, 7, 7, 5` -> 集合为 `{5, 7}`。
*   *修正*：题目中序列为 `2, 6, 1, 5, 7, 7, 7, 5`。
    *   $t$ 时刻访问的是 `5`。
    *   $t-1$ 是 `7`。
    *   $t-2$ 是 `7`。
    *   $t-3$ 是 `7`。
    *   $t-4$ 是 `5`。
    *   如果 $\Delta=4$，我们看最近的4次访问记录：`7, 7, 7, 5`。
    *   包含的页面号集合是 `{5, 7}`。
    *   *注*：如果题目意图是 `1, 5, 7, 7, 7, 5` 且 $\Delta=4$ 覆盖到了 `1` (例如按时间单位而非引用次数)，则包括1。但按标准引用次数定义，只看最近4个。若按上文 "2, 6, 1, 5, 7, 7, 7, 5"，最近4个是 7, 7, 7, 5。如果不包括当前的5而看过去4个，则是 5, 7, 7, 7。集合依然是 {5, 7}。
    *   **特别注意**：很多考题中 $\Delta$ 是**时间单位**。假设每个页面访问耗时1单位。如果 $\Delta=4$，我们看 $t$ 到 $t-4$ 的所有页面。
    *   若此题意为最近4个不同的页面引用，则是另一回事。按标准定义：**集合为 {5, 7}**。如果往前多看一位（比如题目意思 $\Delta$ 较大涵盖了1），则加上1。此处标准答案应基于“最近 $\Delta$ 次访问的唯一页面”。

**(2) 答案：C**
*   **解析：**
    *   缺页间隔 $t < T$，说明缺页间隔很短，**缺页率过高**。
    *   这意味着进程分配的物理内存不够用，出现了“颠簸”的征兆。
    *   **策略：** 应该**增加**该进程的驻留集大小，即增加一个物理块来存放新页面，而不是置换旧页面。
    *   反之，如果 $t > T$（缺页间隔长，缺页率低），说明物理块给多了，可以置换出一段时间未被访问的页面并收回物理块。

---

### 知识点三：工作集和驻留集的关系

**【考点解读】**
*   **工作集 (Working Set, WS)**：进程在某段时间内实际访问的页面集合（由程序局部性决定，是理论上的需求）。
*   **驻留集 (Resident Set, RS)**：操作系统实际给进程分配的物理页框集合。

**【模拟习题 3】**
**简答题：** 简述工作集大小与驻留集大小的关系对系统性能的影响。当驻留集大小小于工作集大小时，会发生什么现象？

**【答案与解析】**
1.  **关系：**
    *   工作集是进程运行的**内在需求**，驻留集是系统提供的**实际资源**。
    *   为了保证进程高效运行，操作系统分配的**驻留集大小应略大于或等于工作集大小**。
2.  **影响：**
    *   **若 驻留集 < 工作集**：进程在运行过程中频繁访问的页面无法全部装入内存，会导致频繁的缺页中断，系统花费大量时间在I/O换页上，进程推进速度极慢，甚至发生**抖动（Thrashing）**。
    *   **若 驻留集 >> 工作集**：虽然缺页率极低，但浪费了宝贵的物理内存资源，导致内存中能容纳的进程数量减少（多道程序度下降），降低了CPU的总体利用率。

---

### 知识点四：抖动（Thrashing）的概念和解决办法 [[抖动的预防与检测]]

**【考点解读】**
抖动是虚拟内存管理中最严重的问题。
*   **现象**：CPU利用率急剧下降，磁盘I/O繁忙。
*   **本质**：多道程序度过高，导致内存不够分。

**【模拟习题 4】**
**选择题：** 某系统正在运行，管理员通过监控发现 CPU 的利用率非常低（例如 < 10%），但磁盘的交换区（Swap）读写频率非常高。此时系统最可能处于什么状态？应采取什么措施？
A. 处于死锁状态；重启系统
B. 处于抖动状态；暂停部分进程，将其换出外存
C. 处于空闲状态；增加更多的新进程进入内存
D. 磁盘故障；更换磁盘

**【答案与解析】**

**答案：B**
*   **解析：**
    *   **现象分析**：CPU低利用率 + 磁盘高I/O = **抖动 (Thrashing)**。说明进程大部分时间都在等待缺页中断的处理（读写磁盘），而不是在计算。
    *   **原因**：内存中的进程数量太多（多道程序度过高），每个进程分到的物理块少于其工作集大小。
    *   **解决办法**：不能增加进程（选C错，会加重抖动）。必须**降低多道程序度**，选择一个或多个进程暂时**挂起（Suspend）**，剥夺它们的物理块分给其他进程，使其满足工作集需求。

---

### 知识点五：分段和段页式

**【考点解读】**
*   **分段**：二维地址空间（段号，段内偏移）。需检查段长越界。
*   **段页式**：先分段，段内再分页。逻辑地址 -> 段表 -> 页表 -> 物理地址。

**【模拟习题 5】**
**(1) 分段地址变换计算：**
某系统采用分段存储管理，段表如下所示：

| 段号 | 段长 | 基址 |
| :--- | :--- | :--- |
| 0 | 500 | 2000 |
| 1 | 200 | 6000 |
| 2 | 100 | 3000 |

请将逻辑地址 `(0, 400)` 和 `(1, 300)` 转换为物理地址。如果有越界错误，请指出。

**(2) 段页式概念题：**
在段页式存储管理中，读取一个数据通常需要访问几次内存？（假设无快表 TLB/Cache）

**【答案与解析】**

**(1) 分段计算答案：**
*   **逻辑地址 (0, 400)：**
    *   段号 $S=0$，查表得段长 $L=500$，基址 $B=2000$。
    *   检查越界：偏移量 $W=400$。
    *   判断：$400 < 500$，**合法**。
    *   物理地址 = 基址 + 偏移量 = $2000 + 400 = \mathbf{2400}$。
*   **逻辑地址 (1, 300)：**
    *   段号 $S=1$，查表得段长 $L=200$，基址 $B=6000$。
    *   检查越界：偏移量 $W=300$。
    *   判断：$300 > 200$，**越界中断**（非法访问）。

**(2) 段页式访问次数答案：3次**
*   **解析：**
    1.  **第1次**：访问内存中的**段表**，根据段号找到该段对应的页表起始地址。
    2.  **第2次**：访问内存中的**页表**，根据页号找到物理块号（帧号）。
    3.  **第3次**：根据物理地址访问**实际数据/指令**。
    *   *注*：如果是单纯的分段或单纯的分页，通常是2次（查表1次+取数1次）。段页式多了一级，所以慢，必须配合TLB使用。