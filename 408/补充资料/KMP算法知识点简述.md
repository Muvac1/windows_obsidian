#KMP算法 是一种改进的字符串匹配算法，主要用于在一个文本串$S$中查找模式串$P$的位置。

*   **核心思想：** 利用匹配失败后的信息，尽量减少模式串与主串的匹配次数以达到快速匹配的目的。
*   **Next数组（前缀表）：** 这是KMP的灵魂。`next[j]`表示当模式串的第$j$个字符失配时，模式串应该跳到哪个位置重新开始匹配。其数值等于模式串下标为$0$到$j-1$的子串中，**最长相等前后缀的长度**。
*   **改进的Next数组（Nextval）：**
    *   **原因：** 未改进的`next`数组在某些情况下（如模式串为`AAAA`，主串为`AAAB`）会出现多余的比较。如果模式串在$j$处失配，回跳到$k=next[j]$，但如果$P[j]==P[k]$，那么在$k$处必然再次失配。
    *   **做法：** 如果$P[j]==P[next[j]]$，则递归地将`next[j]`更新为`next[next[j]]`。
    *   **效果：** 这只是一种**常数级别的优化**，能加快实际运行速度，但不会改变最坏情况下的$O(n+m)$时间复杂度。