[[826历年真题解析-数据结构篇（包括算法题）-12.15.pdf#page=53&rect=16,479,593,810|826历年真题解析-数据结构篇（包括算法题）-12.15, p.53]]
[[Pasted image 20251119214332.png]]
[[Pasted image 20251119214344.png]]
![[Pasted image 20251119214401.png]]



![[Pasted image 20251126174920.png]]
![[Pasted image 20251119214428.png]] 
- 这道题的核心在于利用 #子树大小 （size） 这一信息，跳过无需遍历的节点，从而将时间复杂度从$O(N)$降低到$O(depth(x))$    
1. 后序遍历  
	1. 假设当前根节点为$t$，其左子树节点总数为$S_{left}$（即代码中的`leftSize`），右子树节点总数为$S_{right}$，当前树的总节点数为$S_{total}$（即`t->size`）。根据后序遍历的定义，节点的访问顺序如下  
		1.  **第$1$到第$S_{left}$个节点**：分布在**左子树**中。
		2.  **第$S_{left}+1$到第$S_{left}+S_{right}$个节点**：分布在**右子树**中。
		3.  **第$S_{total}$个节点**（也就是最后一个节点）：是**根节点**$t$自己。
	2. 通过比较目标序号$k$与$S_{left}$的大小关系来判断目标节点在哪里  
		1. 情况一：$k$恰好等于当前树的总大小  
			1. ($k=t \to size$)  
				1. 根据后序遍历“根节点最后访问”的特性，如果$k$等于当前子树的节点总数，说明我们要找的就是当前的根节点$t$。
			    *   *代码对应：* `if (k == t->size) return t;` 
		2. 情况二：$k$落在左子树范围内  ($k \le S_{left}$)  
			1. 如果$k$小于等于左子树的大小，说明目标节点一定在左子树里。我们需要递归地去左子树找第$k$个节点。
			    *   *代码对应：* `else if (k <= leftSize) return rank(t->lc, k);`   
		3. 情况三：$k$落在右子树范围内 ($S_{left} < k < S_{total}$)  
			1. 如果$k$大于左子树大小，且不是根节点，说明目标在右子树中。
			    **关键点：** 当我们跳过左子树进入右子树时，实际上已经“数过”了左子树的$S_{left}$个节点。因此，在右子树中寻找目标时，相对序号（Relative Rank）不再是$k$，而是$k-S_{left}$。
			    *   *代码对应：* `else return rank(t->rc, k - leftSize);`
2. 







![[Pasted image 20251119214439.png]]



![[Pasted image 20251119214446.png]]



![[Pasted image 20251119214500.png]]



![[Pasted image 20251119214507.png]]



![[Pasted image 20251119214516.png]]



![[Pasted image 20251119214528.png]]



![[Pasted image 20251119214538.png]]



![[Pasted image 20251119214641.png]]



![[Pasted image 20251119222422.png]]



![[Pasted image 20251119222431.png]]



![[Pasted image 20251119222513.png]]
![[Pasted image 20251119222521.png]]



![[Pasted image 20251119222531.png]]



![[Pasted image 20251119222540.png]]



![[Pasted image 20251119222549.png]]



![[Pasted image 20251119222605.png]]



![[Pasted image 20251119222659.png]]



![[Pasted image 20251119222711.png]]



![[Pasted image 20251119222719.png]]



![[Pasted image 20251119222727.png]]



![[Pasted image 20251119222733.png]]![[Pasted image 20251119222740.png]]




![[Pasted image 20251119222936.png]]







![[Pasted image 20251119222958.png]]![[Pasted image 20251119223016.png]]





![[Pasted image 20251119223031.png]]![[Pasted image 20251119223038.png]]





